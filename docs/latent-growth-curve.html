<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Clustered Data</title>
  <meta name="description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Clustered Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/clustered-data/" />
  
  <meta property="og:description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations." />
  <meta name="github-repo" content="m-clark/clustered-data/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Clustered Data" />
  
  <meta name="twitter:description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations." />
  



<meta name="date" content="2018-07-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="generalized-estimating-equations.html">
<link rel="next" href="summary.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="https://m-clark.github.io/">Clustered Data</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-approach-to-use"><i class="fa fa-check"></i>What approach to use?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#preliminaries"><i class="fa fa-check"></i>Preliminaries</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#things-to-note"><i class="fa fa-check"></i>Things to note</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-setup.html"><a href="data-setup.html"><i class="fa fa-check"></i>Data setup</a></li>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html"><i class="fa fa-check"></i>Ignore data dependency</a><ul>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html#pros"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html#cons"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html"><i class="fa fa-check"></i>Model every group</a><ul>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html#pros-1"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html#cons-1"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html"><i class="fa fa-check"></i>Cluster robust variances</a><ul>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html#pros-2"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html#cons-2"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html"><i class="fa fa-check"></i>A Survey Approach</a><ul>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html#pros-3"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html#cons-3"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html"><i class="fa fa-check"></i>Fixed Effects Models</a><ul>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#pros-4"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#cons-4"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#pros-5"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#cons-5"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html"><i class="fa fa-check"></i>Generalized Estimating Equations</a><ul>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html#pros-6"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html#cons-6"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html"><i class="fa fa-check"></i>Latent Growth Curve</a><ul>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html#pros-7"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html#cons-7"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a><ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#fixed-effects"><i class="fa fa-check"></i>Fixed Effects</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#variance-estimates"><i class="fa fa-check"></i>Variance estimates</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#robust-se"><i class="fa fa-check"></i>Robust SE</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#fixed-effects-and-panel-data-models"><i class="fa fa-check"></i>Fixed effects and ‘panel’ data models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#mixed-models-1"><i class="fa fa-check"></i>Mixed models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#gee"><i class="fa fa-check"></i>GEE</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#growth-curve-models"><i class="fa fa-check"></i>Growth Curve Models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#survey-analysis"><i class="fa fa-check"></i>Survey Analysis</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#comparisonissues"><i class="fa fa-check"></i>Comparison/Issues</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li class='after'><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="font-size:200%; font-variant:small-caps; ">Clustered Data</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!-- http://stackoverflow.com/questions/37755037/how-to-add-code-folding-to-output-chunks-in-rmarkdown-html-documents/37839683#37839683 -->

<script>
$(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>
<div id="latent-growth-curve" class="section level1">
<h1>Latent Growth Curve</h1>
<p>An alternative approach to mixed models considers the random effects as <span class="emph">latent variables</span> with the outcome at each time point an indicator for the latent variable. I have details <a href="https://m-clark.github.io/docs/sem">elsewhere</a>, but I want to explore this as it is a commonly used technique in the social sciences, especially psychology. <span class="emph">Latent Growth Curve Models</span> are a special case of <span class="emph">structural equation modeling</span>, a highly flexible tool that can incorporate latent variables, indirect effects, multiple outcomes etc. Growth curve models are actually somewhat irregular SEM in the way that they are specified, but for our purposes, we only want to see how the approach works and compare it to previous methods.</p>
<p>The first thing is that the data has to be in <em>wide</em> format, such that we have one column per time point, and thus only one row per individual. Once the data is ready we specify the model syntax. By default, the SEM approach also assumes unequal variances across time, so to make it more comparable, we fix that value to be constant. We’ll use <span class="pack">lavaan</span> to estimate the model.</p>
<div class="fold s">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">dwide =<span class="st"> </span><span class="kw">spread</span>(d, <span class="dt">key=</span>time, <span class="dt">value=</span>y, <span class="dt">sep=</span><span class="st">&#39;_&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">treatment =</span> treatment<span class="op">==</span><span class="st">&#39;treatment&#39;</span>)  <span class="co"># otherwise converted to numeric directly as 1-2 instead of 1-0</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw">head</span>(dwide)</a></code></pre></div>
<pre><code>  treatment id     time_0    time_1    time_2     time_3
1     FALSE  1  0.1760974 0.6928733 0.1920017 -0.2205356
2     FALSE  2  1.4265781 1.6607311 1.2515623  2.9685755
3     FALSE  3 -0.1383776 0.8689109 1.2446484  2.9954976
4     FALSE  4  2.0575643 1.7831405 1.6413706  1.7078853
5     FALSE  5  0.9899045 1.7892770 1.7883325  2.4579697
6     FALSE  6  0.6079163 0.1161267 0.6956824  0.8326176</code></pre>
</div>
<div class="fold s">
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">growthmod_syntax =<span class="st"> &quot;</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st"># model for the intercept and slope latent variables</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  int   =~ 1*time_0 + 1*time_1 + 1*time_2 + 1*time_3</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">  slope =~ 0*time_0 + 1*time_1 + 2*time_2 + 3*time_3</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st"># cluster-level effect</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="st">  int ~ treatment</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"><span class="st"># intercept-slope correlation</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="st">  int ~~ slope</span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="st"># fix to equal variances (parameter &#39;res&#39;)</span></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="st">  time_0 ~~ res*time_0</span></a>
<a class="sourceLine" id="cb42-14" data-line-number="14"><span class="st">  time_1 ~~ res*time_1</span></a>
<a class="sourceLine" id="cb42-15" data-line-number="15"><span class="st">  time_2 ~~ res*time_2</span></a>
<a class="sourceLine" id="cb42-16" data-line-number="16"><span class="st">  time_3 ~~ res*time_3</span></a>
<a class="sourceLine" id="cb42-17" data-line-number="17"><span class="st">&quot;</span></a></code></pre></div>
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">library</span>(lavaan)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">growth_mod =<span class="st"> </span><span class="kw">growth</span>(growthmod_syntax, <span class="dt">data=</span>dwide)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw">summary</span>(growth_mod, <span class="dt">standardized=</span>T)</a></code></pre></div>
<pre><code>lavaan (0.5-23.1097) converged normally after  27 iterations

  Number of observations                          2500

  Estimator                                         ML
  Minimum Function Test Statistic              234.733
  Degrees of freedom                                11
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Information                                 Expected
  Standard Errors                             Standard

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  int =~                                                                
    time_0            1.000                               1.048    0.896
    time_1            1.000                               1.048    0.931
    time_2            1.000                               1.048    0.863
    time_3            1.000                               1.048    0.742
  slope =~                                                              
    time_0            0.000                               0.000    0.000
    time_1            1.000                               0.394    0.350
    time_2            2.000                               0.788    0.648
    time_3            3.000                               1.182    0.836

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  int ~                                                                 
    treatment        -0.434    0.041  -10.686    0.000   -0.414   -0.207

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .int ~~                                                                
    slope            -0.128    0.011  -11.522    0.000   -0.317   -0.317

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .time_0            0.000                               0.000    0.000
   .time_1            0.000                               0.000    0.000
   .time_2            0.000                               0.000    0.000
   .time_3            0.000                               0.000    0.000
   .int               0.137    0.030    4.553    0.000    0.131    0.131
    slope             0.509    0.009   55.635    0.000    1.291    1.291

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .time_0   (res)    0.269    0.005   50.000    0.000    0.269    0.197
   .time_1   (res)    0.269    0.005   50.000    0.000    0.269    0.212
   .time_2   (res)    0.269    0.005   50.000    0.000    0.269    0.182
   .time_3   (res)    0.269    0.005   50.000    0.000    0.269    0.135
   .int               1.052    0.035   29.817    0.000    0.957    0.957
    slope             0.155    0.006   25.828    0.000    1.000    1.000</code></pre>
<p>The <code>Intercepts:</code> section of the output shows what would be the fixed effects in the mixed model, and in this case, they are in fact ‘intercepts’ in this latent variable approach, so that is why they are named as such. The Regression of <code>int</code> on treatment depicts the treatment effect, and will make more sense to those who come to mixed models from the <span class="emph">multilevel modeling</span> literature. If you go back to the model depiction for the mixed model, this model more explicitly denotes <span class="math inline">\(\beta_{0c} = \beta_0 + \beta_2*\textrm{Treatment} + \gamma_c\)</span>. The <code>res</code> parameter is the arbitray name I’ve given for the residual variance, and is roughly equivalent to the square of the residual standard deviation in the mixed model output. The above model does not allow for correlated residuals, though this is possible<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
<p>The primary point here is not to precisely reproduce the correct model but to show the identity between the mixed model and the latent growth curve approach. Proper specification will lead to identical results between latent growth curve and mixed models. The following creates a mixed model that is the equivalent.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">mixed_mod_nocorr =<span class="st"> </span><span class="kw">lme</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treatment, <span class="dt">data=</span>d, <span class="dt">random=</span><span class="op">~</span><span class="dv">1</span><span class="op">+</span>time<span class="op">|</span>id, <span class="dt">method=</span><span class="st">&quot;ML&quot;</span>)</a></code></pre></div>
<table>
<caption>Fixed effects: y ~ time + treatment</caption>
<colgroup>
<col width="34%" />
<col width="12%" />
<col width="16%" />
<col width="9%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Value</th>
<th align="center">Std.Error</th>
<th align="center">DF</th>
<th align="center">t-value</th>
<th align="center">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">0.137</td>
<td align="center">0.030</td>
<td align="center">7499</td>
<td align="center">4.552</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>time</strong></td>
<td align="center">0.509</td>
<td align="center">0.009</td>
<td align="center">7499</td>
<td align="center">55.626</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>treatmenttreatment</strong></td>
<td align="center">-0.434</td>
<td align="center">0.041</td>
<td align="center">2498</td>
<td align="center">-10.685</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:50%;">
<caption>Standardized Within-Group Residuals</caption>
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min</th>
<th align="center">Q1</th>
<th align="center">Med</th>
<th align="center">Q3</th>
<th align="center">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-3.58</td>
<td align="center">-0.51</td>
<td align="center">0.01</td>
<td align="center">0.5</td>
<td align="center">3.28</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Linear mixed-effects model fit by maximum likelihood : y ~ time + treatment</caption>
<colgroup>
<col width="12%" />
<col width="20%" />
<col width="12%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Observations</th>
<th align="center">Groups</th>
<th align="center">Log-restricted-likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>id</strong></td>
<td align="center">10000</td>
<td align="center">2500</td>
<td align="center">-12732</td>
</tr>
</tbody>
</table>
<table style="width:31%;">
<colgroup>
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Variance</th>
<th align="center">StdDev</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.052</td>
<td align="center">1.026</td>
</tr>
<tr class="even">
<td align="center">0.155</td>
<td align="center">0.394</td>
</tr>
<tr class="odd">
<td align="center">0.269</td>
<td align="center">0.519</td>
</tr>
</tbody>
</table>
<div id="pros-7" class="section level2">
<h2>Pros</h2>
<ul>
<li>Can be utilized on less data than typical SEM</li>
<li>Very efficient estimation</li>
<li>Can deal with very complex models, including mediation, parallel processes etc.</li>
</ul>
</div>
<div id="cons-7" class="section level2">
<h2>Cons</h2>
<ul>
<li>Tedious to specify even the simplest of models</li>
<li>Very tedious to specify even common extensions (e.g. time-varying covariates)</li>
<li>Even worse to get into correlated residuals</li>
<li>More complex cluster structure is not dealt with well (if at all)<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></li>
<li>Assumes balanced time points</li>
<li>Doesn’t deal with many time points well (if also time-varying covariates especially)</li>
</ul>
<p>Gist: Growth curve models are very flexible, but they are also problematic simply because they are from the SEM world, which is one where models are notoriously misapplied. Furthermore, there are no common uses of growth curve models that would not be more easily implemented in one of several R packages<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> and various other languages and statistical programs. While I find the latent variable interpretation very much intriguing, the latent variable approach is not something I’d normally consider for this setting.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>See my LGC chapter in this <a href="https://m-clark.github.io/docs/sem">SEM document</a>. Once you see it there you’ll know why I did not do so here.<a href="latent-growth-curve.html#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>MPlus has <a href="https://www.statmodel.com/download/handouts/MuthenV7Part3.pdf">recently</a> incorporated the ability to handle crossed random effects (and see example 9.24 in the version 7 manual), but I have no idea how they work in realistic situations with potentially many, possibly time-varying, covariates, and it’s actually done with their multilevel approach rather than the LGC we’ve been discussing. Furthermore, it requires the Bayesian estimator, which, if you’re going that route you might as well use <span class="pack">rstan</span>, <span class="pack">rjags</span> or similar and have a lot more utility (and clarity) at your disposal. For tools like <span class="pack">lme4</span> and similar, incorporating crossed random effects are no more difficult than other situations, i.e. are 1 line of code, while you’d be debugging the MPlus output for days.<a href="latent-growth-curve.html#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p>See the <span class="pack">mediation</span> package for mediation with mixed models, <span class="pack">flexMix</span> for growth mixture models, Bayesian approaches for parallel processes etc.<a href="latent-growth-curve.html#fnref21" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalized-estimating-equations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Clustered_Data.pdf", "Clustered_Data.epub"],
"toc": {
"collapse": "section",
"edit": null,
"depth": 2,
"scroll_highlight": true
},
"highlight": "pygments",
"search": true,
"epub": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
