<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Clustered Data</title>
  <meta name="description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Clustered Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/clustered-data/" />
  
  <meta property="og:description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations." />
  <meta name="github-repo" content="m-clark/clustered-data/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Clustered Data" />
  
  <meta name="twitter:description" content="This document provides a brief comparison of various approaches to dealing with clustered data situations." />
  



<meta name="date" content="2018-04-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="mixed-models.html">
<link rel="next" href="latent-growth-curve.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="https://m-clark.github.io/">Clustered Data</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-approach-to-use"><i class="fa fa-check"></i>What approach to use?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#preliminaries"><i class="fa fa-check"></i>Preliminaries</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#things-to-note"><i class="fa fa-check"></i>Things to note</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-setup.html"><a href="data-setup.html"><i class="fa fa-check"></i>Data setup</a></li>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html"><i class="fa fa-check"></i>Ignore data dependency</a><ul>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html#pros"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="ignore-data-dependency.html"><a href="ignore-data-dependency.html#cons"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html"><i class="fa fa-check"></i>Model every group</a><ul>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html#pros-1"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="model-every-group.html"><a href="model-every-group.html#cons-1"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html"><i class="fa fa-check"></i>Cluster robust variances</a><ul>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html#pros-2"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="cluster-robust-variances.html"><a href="cluster-robust-variances.html#cons-2"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html"><i class="fa fa-check"></i>A Survey Approach</a><ul>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html#pros-3"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="a-survey-approach.html"><a href="a-survey-approach.html#cons-3"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html"><i class="fa fa-check"></i>Fixed Effects Models</a><ul>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#pros-4"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#cons-4"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#pros-5"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#cons-5"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html"><i class="fa fa-check"></i>Generalized Estimating Equations</a><ul>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html#pros-6"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="generalized-estimating-equations.html"><a href="generalized-estimating-equations.html#cons-6"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html"><i class="fa fa-check"></i>Latent Growth Curve</a><ul>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html#pros-7"><i class="fa fa-check"></i>Pros</a></li>
<li class="chapter" data-level="" data-path="latent-growth-curve.html"><a href="latent-growth-curve.html#cons-7"><i class="fa fa-check"></i>Cons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a><ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#fixed-effects"><i class="fa fa-check"></i>Fixed Effects</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#variance-estimates"><i class="fa fa-check"></i>Variance estimates</a></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#robust-se"><i class="fa fa-check"></i>Robust SE</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#fixed-effects-and-panel-data-models"><i class="fa fa-check"></i>Fixed effects and ‘panel’ data models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#mixed-models-1"><i class="fa fa-check"></i>Mixed models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#gee"><i class="fa fa-check"></i>GEE</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#growth-curve-models"><i class="fa fa-check"></i>Growth Curve Models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#survey-analysis"><i class="fa fa-check"></i>Survey Analysis</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#comparisonissues"><i class="fa fa-check"></i>Comparison/Issues</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li class='after'><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="font-size:200%; font-variant:small-caps; ">Clustered Data</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!-- http://stackoverflow.com/questions/37755037/how-to-add-code-folding-to-output-chunks-in-rmarkdown-html-documents/37839683#37839683 -->

<script>
$(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>
<div id="generalized-estimating-equations" class="section level1">
<h1>Generalized Estimating Equations</h1>
<p>A <span class="emph">generalized estimating equation</span> is an <em>estimation procedure</em><a href="#fn13" class="footnoteRef" id="fnref13"><sup>13</sup></a> for dealing with clustered data, and is seemingly very popular in disciplines trained with a biostatistics perspective, but perhaps not too commonly used elsewhere. Models using this approach are sometimes called <span class="emph">marginal models</span>, and can be seen as follows, where the target <span class="math inline">\(y\)</span> is multivariate normal with mean vector <span class="math inline">\(X\beta\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>, which is typically block diagonal as we created at the beginning<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a>.</p>
<p><span class="math display">\[ y \sim \mathcal{N}(X\beta,  \Sigma) \]</span></p>
<p>Here the focus is on the ‘population average’ effects, akin to ‘fixed’ effects in the RE model, and in some circumstances they are identical. In addition, one specifies the type of covariance structure thought to underlie the data. Among the more common are:</p>
<ul>
<li><em>independence</em>: no correlation</li>
<li><em>autoregressive</em>: as described previously</li>
<li><em>exchangeable</em>: same correlation everywhere (aka ‘compound symmetry’ or ‘spherical’)</li>
<li><em>unstructured</em>: all possible correlations are estimated as parameters</li>
</ul>
<p>And there are many others. The GEE approach is identical to RE intercept-only model approach if one conducts a linear Gaussian model, as in this case. In addition, these correlation structures are often available to mixed models tools, so this extension alone should not be a reason<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a> to use the GEE approach.</p>
<p>We’ll use the <span class="pack">geepack</span> package in order to conduct the gee approach to the model. We’ll specify an autoregressive correlation structure as we did with the mixed model, and as the data was in fact designed with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(geepack)

gee_mod =<span class="st"> </span><span class="kw">geeglm</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treatment, <span class="dt">data=</span>d, <span class="dt">corstr=</span><span class="st">&#39;ar1&#39;</span>, <span class="dt">id=</span>id, <span class="dt">waves=</span>time)</code></pre></div>
<table style="width:90%;">
<colgroup>
<col width="34%" />
<col width="15%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std.err</th>
<th align="center">Wald</th>
<th align="center">Pr(&gt;|W|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">0.127</td>
<td align="center">0.030</td>
<td align="center">17.7</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>time</strong></td>
<td align="center">0.507</td>
<td align="center">0.009</td>
<td align="center">3117.9</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>treatmenttreatment</strong></td>
<td align="center">-0.413</td>
<td align="center">0.041</td>
<td align="center">100.6</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:26%;">
<colgroup>
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Residual Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.48</td>
</tr>
</tbody>
</table>
<table style="width:47%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std.err</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>alpha</strong></td>
<td align="center">0.757</td>
<td align="center">0.007</td>
</tr>
</tbody>
</table>
<p>We should be getting used to the coefficient estimates for the population-average, a.k.a. fixed effects, by now. We also obtain an estimate for the residual correlation, here noted as <em>alpha</em>.</p>
<p>Note the similarities here compared with the mixed model where there is only a random intercept. A couple of changes are made to keep things as similar as possible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mixed_mod_ri_only =<span class="st"> </span><span class="kw">lme</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>treatment, <span class="dt">data=</span>d, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>id, <span class="dt">cor=</span><span class="kw">corAR1</span>(<span class="dt">form=</span><span class="op">~</span>time), 
                        <span class="dt">control=</span><span class="kw">lmeControl</span>(<span class="dt">opt=</span><span class="st">&#39;optim&#39;</span>), <span class="dt">method=</span><span class="st">&#39;ML&#39;</span>)  <span class="co"># changed opt bc nlminb had issues</span></code></pre></div>
<table>
<caption>Fixed effects: y ~ time + treatment</caption>
<colgroup>
<col width="34%" />
<col width="12%" />
<col width="16%" />
<col width="9%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Value</th>
<th align="center">Std.Error</th>
<th align="center">DF</th>
<th align="center">t-value</th>
<th align="center">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">0.126</td>
<td align="center">0.032</td>
<td align="center">7499</td>
<td align="center">3.92</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>time</strong></td>
<td align="center">0.507</td>
<td align="center">0.008</td>
<td align="center">7499</td>
<td align="center">60.59</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>treatmenttreatment</strong></td>
<td align="center">-0.412</td>
<td align="center">0.042</td>
<td align="center">2498</td>
<td align="center">-9.82</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:51%;">
<caption>Standardized Within-Group Residuals</caption>
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min</th>
<th align="center">Q1</th>
<th align="center">Med</th>
<th align="center">Q3</th>
<th align="center">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-3.85</td>
<td align="center">-0.66</td>
<td align="center">0.03</td>
<td align="center">0.66</td>
<td align="center">3.45</td>
</tr>
</tbody>
</table>
<table style="width:83%;">
<caption>Linear mixed-effects model fit by maximum likelihood : y ~ time + treatment</caption>
<colgroup>
<col width="12%" />
<col width="20%" />
<col width="12%" />
<col width="37%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Observations</th>
<th align="center">Groups</th>
<th align="center">Log-restricted-likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>id</strong></td>
<td align="center">10000</td>
<td align="center">2500</td>
<td align="center">-12707</td>
</tr>
</tbody>
</table>
<table style="width:26%;">
<colgroup>
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Variance</th>
<th align="center">StdDev</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.003</td>
<td align="center">0.051</td>
</tr>
<tr class="even">
<td align="center">1.504</td>
<td align="center">1.227</td>
</tr>
</tbody>
</table>
<table style="width:8%;">
<colgroup>
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Phi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.78</td>
</tr>
</tbody>
</table>
<p>The population average effects are identical (though the <span class="func">geeglm</span> function automatically does cluster robust standard errors). The estimated correlations for both are similar, and a bit high. There is essentially no cluster variance in the mixed model, and both estimated residual variances are similar, and similar to the standard linear model we started with. This makes sense as the variance is equal to the residual variance + the intercept variance + slope variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm_mod)<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span>                   <span class="co"># similar to gee and random intercept only</span></code></pre></div>
<pre><code>[1] 1.479611</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">as.numeric</span>(<span class="kw">VarCorr</span>(mixed_mod)[,<span class="dv">1</span>]))   <span class="co"># model that incorporates all sources of variance</span></code></pre></div>
<pre><code>[1] 1.306739</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">intsd<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>timesd<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sigmasq              <span class="co"># &#39;truth&#39;</span></code></pre></div>
<pre><code>[1] 1.3125</code></pre>
<p>GEE models are generally robust to misspecification of the covariance structure. They are rarely implemented for more than simple clustering but some tools allow for it<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a>.</p>
<p>Where GEE differ from random effects models in interpretation regards non-Gaussian models. Consider a gender effect for a binary outcome where individuals are nested within families. In this case we could use a standard logistic regression, but would want to take the clustering into account. The gender effect for GEE is comparing hypothetical males in many different families to hypothetical females in many different families (controlling for other covariates). In the mixed model with a random effect for family, you are comparing males in one family to females in the same family (again controlling for other factors). The latter odds ratio will typically be larger because there is less fluctuation due to family-to-family differences<a href="#fn17" class="footnoteRef" id="fnref17"><sup>17</sup></a>. However, this isn’t a <em>larger</em> effect, just a different one.</p>
<div id="pros-6" class="section level2">
<h2>Pros</h2>
<ul>
<li>Easy modeling of different correlation structures</li>
<li>Focus on population level effects</li>
<li>Extends the cluster robust approach to GLM setting and other correlation structures<a href="#fn18" class="footnoteRef" id="fnref18"><sup>18</sup></a></li>
<li>Robust to misspecification of correlation structure</li>
<li>May be more feasible with larger data situations than mixed models</li>
</ul>
</div>
<div id="cons-6" class="section level2">
<h2>Cons</h2>
<ul>
<li>Cluster-specific effects are not estimated</li>
<li>Not easily extendable to other clustering situations, e.g. nested</li>
<li>Missing data is assumed Missing Completely at Random (MCAR) (RE and FE assume MAR)</li>
</ul>
<p>Gist: If your goal is to focus on population average effects and ignore subject specific effects, without the drawbacks of the FE model, the GEE approach might be considered.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>Not a model! We’re just doing a GLM here.<a href="generalized-estimating-equations.html#fnref13">↩</a></p></li>
<li id="fn14"><p>The corresponding matrix formulation for the <em>conditional</em> model of the random effects approach is: <span class="math display">\[ y \sim \mathcal{N}(X\beta + Z\Gamma,  \Sigma) \]</span> where <span class="math inline">\(Z\)</span> is some subset of <span class="math inline">\(X\)</span>, and <span class="math inline">\(\Gamma\)</span> contains the random effects.<a href="generalized-estimating-equations.html#fnref14">↩</a></p></li>
<li id="fn15"><p><span class="pack">lme4</span> is a very widely used mixed model package that does not allow the specification of a correlation structure for the residuals.<a href="generalized-estimating-equations.html#fnref15">↩</a></p></li>
<li id="fn16"><p>CSCAR director and University of Michigan statistics faculty <a href="https://github.com/kshedden">Kerby Shedden</a> has worked on a Python implementation for nested structures as part of the <a href="http://statsmodels.sourceforge.net/devel/gee.html">statsmodels module</a>.<a href="generalized-estimating-equations.html#fnref16">↩</a></p></li>
<li id="fn17"><p>This is a paraphrase of a response by Kerby Shedden to a question on the CSCAR help list that I thought was succinct and easy to understand. He continues: “I don’t have a strong opinion about this. It is almost always good to control for observed variables to reduce heterogeneity and get a sharper analysis. But it’s less clear to me that you should control for things that are unattributable (e.g. family effects of unknown cause), even if it is technically possible to do so. It comes down to this: do you want to measure my risk (for being male) by comparing me to my sister (or an imaginary sister who is identical to me in all observables except gender)…or do you want to compare me to an unrelated female, also identical to me in terms of all observables?”<a href="generalized-estimating-equations.html#fnref17">↩</a></p></li>
<li id="fn18"><p>Recall the note at the end of the <a href="cluster-robust-variances.html#cluster-robust-variances">cluster robust SE chapter</a>.<a href="generalized-estimating-equations.html#fnref18">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="latent-growth-curve.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Clustered_Data.pdf", "Clustered_Data.epub"],
"toc": {
"collapse": "section",
"edit": null,
"depth": 2,
"scroll_highlight": true
},
"highlight": "pygments",
"search": true,
"epub": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
